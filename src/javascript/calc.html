<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Calculator</title>

  <script type="text/javascript" src="arith-plugin.js">
  </script>

  <script type="text/javascript">

    /**
     * Author: Brian Gianforcaro bjg1955@cs.rit.edu
     * PLC Lab #3: JavaScript 
     */

     var model = {};


    /**
     * Short hand for doc.createElem..(..)
     * @param 
     */

    function newElm( str )
    {
        return document.createElement(str);
    }

    /**
     * Short-Hand function to call doc.getElembyId(...)
     * @param el - element to snag from the DOM.
     * @return The selected id
     */
    function byId( el )
    { 
      return document.getElementById( el );
    }

    function genButtons(btnCanvas) 
    {
      content = "";

      var ops = [];
      for (prop in model.opNames) 
      {
        ops.push(prop);
      }

      for( row = 3; row >= 0 ; row-- )
      {
    
        for( col = (row * 3) - 2; col <= (row * 3); col++ )
        {
          content = content + ("<button onClick=\"model.stack.push(" + col + ");\" >" + col + "</button>");
        }

        op = model.opNames[ops[row]];
        console.log(op);

        content = content + "<button onClick=\'model.opList[" + op + "];\'>" + ops[row] + "</button>";
        content = content + "<br>";

      }
      btnCanvas.innerHTML = content;
    }

    function render()
    {

      initModel();

      canvas = byId("canvas")

      /* Create the table and set it's properties */
      table = newElm('table');
      table.align = "center";
      table.border = "0";

      tbody = newElm('tbody');

      tr = newElm('tbody');

      td = newElm('td');
      td.colspan = "4";


      input = newElm('input');
      input.type = "text";

      div = newElm('div');
      div.id = "button-canvas";

      /* Constuct the table of all indvidual elements. */
      td.appendChild( input );
      tr.appendChild( td );
      tbody.appendChild( tr );
      tbody.appendChild( div );
      table.appendChild( tbody );

      /* Append the final table to the canvas */
      canvas.appendChild( table );
    
      genButtons( div );
    }


    function initModel()
    {
        model = Arith();

        /* Attatch our opList and opNames */

        /**
         * An object that maps the string names of the calculator's 
         * operation buttons to the operation methods above by use
         * of its property names and values. 
         */
        model.opList = {
                          "addition":    function ()
                                         {
                                          first = model.stack.pop();
                                          second = model.stack.pop();
                                          model.setStackTop( first + second );
                                         },
                          "subtraction": function() 
                                         {
                                            first = model.stack.pop();
                                            second = model.stack.pop();
                                            model.setStackTop( first - second );
                                         }
,
                          "multiplicaiton":multiplication(),
                          "division":division() 
                       };

       /** 
        * An array of up to four symbols for the operations. 
        * The symbols should match the names of the properties in opList.
        */
        model.opNames = { 
                          "+":"addition", 
                          "-":"subtraction",
                          "*":"multiplicaiton",
                          "/":"division"
                        };
    }

    /**
     * Subtraction operator callback
     */
    subtraction = function() 
    {
        first = model.stack.pop();
        second = model.stack.pop();

        model.setStackTop( first - second );
    }

    /**
     * Multiplication operator callback
     */ 
    multiplication = function ()
    {
        first = model.stack.pop();    
        second = model.stack.pop();

        model.setStackTop( first * second ); 
    }

    /**
     * division operator callback
     */ 
    division = function () 
    {
        divisor = model.stack.pop();
        dividend = model.stack.pop(); 

        divisor/divident;

        model.setStackTop( divisor/divident );

    }

  </script>

</head>
<body onload="render();">
    <div id="canvas">
    </div>
</body>
</html>
